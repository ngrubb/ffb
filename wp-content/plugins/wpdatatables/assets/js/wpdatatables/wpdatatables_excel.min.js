function wdtStripTags(a,b){var c=/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,d=/<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi;return b=(((b||"")+"").toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join(""),a.replace(d,"").replace(c,function(a,c){return b.indexOf("<"+c.toLowerCase()+">")>-1?a:""})}!function(a,b){function e(){var b=a.editors.TextEditor.prototype.extend();b.prototype.bindEvents=function(){this.eventManager.addEventListener(this.TEXTAREA,"keydown",function(b){b.which==a.helper.KEY_CODES.ENTER&&a.Dom.stopImmediatePropagation(b)})},a.editors.ExcelMultilineEditor=b,a.editors.registerEditor("wdt.text_multiline",b)}function f(){var b=a.editors.DateEditor.prototype.extend();b.prototype.init=function(){a.editors.DateEditor.prototype.init.apply(this,arguments);var b=this.instance.getSettings();this.same_display_and_edit_format=b.dataSourceDateFormat==b.displayDateFormat},b.prototype.onBeforeKeyDown=function(b){switch(b.keyCode){case a.helper.KEY_CODES.ESCAPE:var c=this.getActiveEditor();c.finishEditing(!0)}},b.prototype.discardEditor=function(b){a.editors.DateEditor.prototype.discardEditor.apply(this,arguments);var c=this.instance,d=c.getCellMeta(this.row,this.col).allowInvalid;d||b||this.$datePicker.$node.isVisible()||(this.datePickerStyle.display="block",this.$datePicker.show())},b.prototype.open=function(){this.instance.addHook("beforeKeyDown",this.onBeforeKeyDown),a.editors.DateEditor.prototype.open.apply(this,arguments)},b.prototype.close=function(){a.editors.DateEditor.prototype.close.apply(this,arguments),this.instance.removeHook("beforeKeyDown",this.onBeforeKeyDown)},b.prototype.prepare=function(b,c,d,e,f,g){if(f&&"0000-00-00"!=f||(f=""),f&&!this.same_display_and_edit_format){var h=this.instance.getSettings();f=moment(f,h.dataSourceDateFormat).format(h.displayDateFormat)}a.editors.DateEditor.prototype.prepare.apply(this,arguments)},b.prototype.saveValue=function(b,c){if(b[0][0]&&!this.same_display_and_edit_format){var d=this.instance.getSettings();b[0][0]=moment(b[0][0],d.displayDateFormat).format(d.dataSourceDateFormat)}a.editors.DateEditor.prototype.saveValue.apply(this,arguments)},a.editors.ExcelDateEditor=b,a.editors.registerEditor("wdt.date",b)}function g(){var c=a.editors.DateEditor.prototype.extend();c.prototype.init=function(){a.editors.DateEditor.prototype.init.apply(this,arguments);var b=this.instance.getSettings();this.same_display_and_edit_format=b.dataSourceDateFormat==b.displayDateFormat,this.time_format=b.timeFormat},c.prototype.createElements=function(){a.editors.DateEditor.prototype.createElements.apply(this,arguments),this.timePicker=document.createElement("INPUT"),this.timePickerStyle=this.datePicker.style,this.timePickerStyle.position="absolute",this.timePickerStyle.top=0,this.timePickerStyle.left=0,this.timePickerStyle.zIndex=9999,this.timePicker.className+="htTimepickerHolder",document.body.appendChild(this.timePicker),this.$timePicker=b(this.timePicker).pickatime(this.getTimePickerConfig()).pickatime("picker")},c.prototype.destroy=function(){this.$datePicker.destroy(),this.$timePicker.destroy()},c.prototype.getDatePickerConfig=function(){var b=a.editors.DateEditor.prototype.getDatePickerConfig.apply(this,arguments),c=this,e=(b.onSelect,b.onClose);return b.onSelect=function(a){isNaN(a.getTime())||(a=moment(a).format(c.cellProperties.dateFormat||c.defaultDateFormat)),c.showTimepicker()},b.onClose=function(){c.parentDestroyed||c.finishEditing(!1),e&&e()},b},c.prototype.showTimepicker=function(){this.$timePicker.open()},c.prototype.hideTimepicker=function(){this.hideDatepicker(),"undefined"!=typeof this.$timePicker&&this.$timePicker.close()},c.prototype.onBeforeKeyDown=function(b){switch(b.keyCode){case a.helper.KEY_CODES.ESCAPE:var c=this.getActiveEditor();c.finishEditing(!0)}},c.prototype.discardEditor=function(b){a.editors.DateEditor.prototype.discardEditor.apply(this,arguments);var c=this.instance,d=c.getCellMeta(this.row,this.col).allowInvalid;d||b||this.$datePicker.isVisible()||(this.datePickerStyle.display="block",this.$datePicker.show())},c.prototype.getTimePickerConfig=function(){var a=this.instance.getSettings(),c=this,d={container:".wpExcelTable",interval:a.timepickRange,format:a.timepickTimeFormat,onRender:function(){b("<button>"+wpdatatables_frontend_strings.back_to_date+"</button>").on("click",function(){c.hideTimepicker(),c.showDatepicker()}).prependTo(this.$root.find(".picker__box"))},onSet:function(a){"select"in a&&(c.setValue(c.$datePicker.getMoment().format(c.cellProperties.dateFormat||c.defaultDateFormat)+" "+this.get()),c.hideDatepicker()),"clear"in a&&(c.setValue(""),c.hideDatepicker())},onClose:function(){c.hideDatepicker(),b(":focus").blur()}};return d},c.prototype.open=function(){this.instance.addHook("beforeKeyDown",this.onBeforeKeyDown);a.editors.DateEditor.prototype.open.apply(this,arguments)},c.prototype.close=function(){a.editors.DateEditor.prototype.close.apply(this,arguments),this.instance.removeHook("beforeKeyDown",this.onBeforeKeyDown)},c.prototype.finishEditing=function(){var b=void 0!==arguments[0]&&arguments[0],c=void 0!==arguments[1]&&arguments[1];if(b){var d=this.originalValue;void 0!==d&&this.setValue(d),this.hideDatepicker()}$traceurRuntime.superGet(this,a.editors.DateEditor.prototype,"finishEditing").call(this,b,c)},c.prototype.prepare=function(b,c,d,e,f,g){if(f&&"0000-00-00 00:00:00"!=f||(f=""),f&&!this.same_display_and_edit_format){var h=this.instance.getSettings();f=moment(f,h.dataSourceDateFormat+" hh:mm:ss").format(h.displayDateFormat+" "+h.momentTimeFormat)}a.editors.DateEditor.prototype.prepare.apply(this,arguments)},c.prototype.saveValue=function(b,c){if(b[0][0]&&!this.same_display_and_edit_format){var d=this.instance.getSettings();b[0][0]=moment(b[0][0],d.displayDateFormat+" "+d.momentTimeFormat).format(d.dataSourceDateFormat+" H:mm:ss")}a.editors.DateEditor.prototype.saveValue.apply(this,arguments)},a.editors.ExcelDateTimeEditor=c,a.editors.registerEditor("wdt.datetime",c)}function h(){var c=a.editors.TextEditor.prototype.extend();c.prototype.init=function(){a.editors.TextEditor.prototype.init.apply(this,arguments);var b=this.instance.getSettings();this.time_format=b.timeFormat;var c=this;this.instance.addHook("afterDestroy",function(){c.parentDestroyed=!0,c.destroyElements()})},c.prototype.createElements=function(){a.editors.TextEditor.prototype.createElements.apply(this,arguments),this.timePicker=document.createElement("INPUT"),this.timePickerStyle=this.timePicker.style,this.timePickerStyle.position="absolute",this.timePickerStyle.top=0,this.timePickerStyle.left=0,this.timePickerStyle.zIndex=9999,this.timePicker.className+="htTimepickerHolder",document.body.appendChild(this.timePicker),this.$timePicker=b(this.timePicker).pickatime(this.getTimePickerConfig()).pickatime("picker")},c.prototype.destroy=function(){this.$timePicker.destroy()},c.prototype.showTimepicker=function(){this.$timePicker.open()},c.prototype.hideTimepicker=function(){"undefined"!=typeof this.$timePicker&&this.$timePicker.close()},c.prototype.onBeforeKeyDown=function(b){switch(b.keyCode){case a.helper.KEY_CODES.ESCAPE:var c=this.getActiveEditor();c.finishEditing(!0);break;case a.helper.KEY_CODES.ARROW_DOWN:case a.helper.KEY_CODES.ARROW_UP:var c=this.getActiveEditor();c.showTimepicker()}},c.prototype.beginEditing=function(b){a.editors.TextEditor.prototype.beginEditing.apply(this,arguments)},c.prototype.discardEditor=function(b){a.editors.TextEditor.prototype.discardEditor.apply(this,arguments);var c=this.instance,d=c.getCellMeta(this.row,this.col).allowInvalid;d||b||this.$timePicker.$node.is(":visible")||this.$timePicker.open()},c.prototype.getTimePickerConfig=function(){var a=this.instance.getSettings(),c=this,d={container:".wpExcelTable",interval:a.timepickRange,format:a.timepickTimeFormat,onSet:function(a){"select"in a&&(c.setValue(this.get()),c.finishEditing()),"clear"in a&&c.setValue("")},onClose:function(){b(":focus").blur()}};return d},c.prototype.open=function(){this.instance.addHook("beforeKeyDown",this.onBeforeKeyDown),a.editors.TextEditor.prototype.open.apply(this,arguments)},c.prototype.beginEditing=function(){a.editors.TextEditor.prototype.beginEditing.apply(this,arguments)},c.prototype.focus=function(b){a.editors.DateEditor.prototype.focus.apply(this,arguments)},c.prototype.close=function(){this.hideTimepicker(),this.instance.removeHook("beforeKeyDown",this.onBeforeKeyDown),a.editors.TextEditor.prototype.close.apply(this,arguments)},c.prototype.finishEditing=function(){var b=void 0!==arguments[0]&&arguments[0];void 0!==arguments[1]&&arguments[1];if(b){var d=this.originalValue;void 0!==d&&this.setValue(d)}a.editors.TextEditor.prototype.finishEditing.apply(this,arguments)},c.prototype.prepare=function(b,c,d,e,f,g){if(f){var h=this.instance.getSettings();f=moment(f,"H:mm:ss").format(h.momentTimeFormat)}else f="";a.editors.TextEditor.prototype.prepare.apply(this,arguments)},c.prototype.saveValue=function(b,c){if(b[0][0]){var d=this.instance.getSettings();b[0][0]=moment(b[0][0],d.momentTimeFormat).format("H:mm:ss")}a.editors.TextEditor.prototype.saveValue.apply(this,arguments)},a.editors.ExcelTimeEditor=c,a.editors.registerEditor("wdt.time",c)}function i(){var c=a.editors.BaseEditor.prototype.extend();c.prototype.init=function(){this.wdtCustomUploader=wp.media({title:wpdatatables_frontend_strings.select_upload_file,button:{text:wpdatatables_frontend_strings.choose_file},multiple:!1});var a=this,c=this.instance;this.wdtCustomUploader.on("select",function(){var b=a.wdtCustomUploader.state().get("selection").first().toJSON(),d=c.getCellRenderer(a.row,a.col).name,e=b.url;if("wdtImageRenderer"==d)if("image"!=b.type)e="";else{var f=new URI(e);if(f.setQuery({img_width:b.width,img_height:b.height}),e=f.toString(),b.sizes.thumbnail){var g=new URI(b.sizes.thumbnail.url);g.setQuery({img_width:b.sizes.thumbnail.width,img_height:b.sizes.thumbnail.height}),e=g.toString()+"||"+e}}c.setDataAtCell(a.row,a.col,e)}),$browseButton=b('<button class="button-primary">'+wpdatatables_frontend_strings.browse_file+"</button>"),b($browseButton).click(function(a){a.preventDefault(),c.getActiveEditor().wdtCustomUploader.open()}),this.BROWSE_BUTTON=$browseButton[0],this.INPUT_FILE_URL=b('<input type="hidden" />')[0],this.UPLOADED_FILES_ELEMENTS=document.createElement("p"),$editorCnt=b('<div class="wdtAttachmentEditorHolder" ></div>').append(this.UPLOADED_FILES_ELEMENTS,this.BROWSE_BUTTON,this.INPUT_FILE_URL).hide(),this.EDITOR_CONTENT=$editorCnt[0],this.editorContainerStyle=this.EDITOR_CONTENT.style,this.instance.rootElement.appendChild(this.EDITOR_CONTENT)},c.prototype.getValue=function(){return this.INPUT_FILE_URL.value},c.prototype.setValue=function(a){this.INPUT_FILE_URL.value=a;var c="",d=this.instance;if(""!=a){var c,e=a.split("||")[0];c="wdtImageRenderer"==d.getCellRenderer(this.row,this.col).name?b('<img src="'+e+'" />').css({"max-width":"100px","max-height":"50px"})[0].outerHTML:a.split("/").pop(),c+='<span class="delete_file">[<a href="#">'+wpdatatables_frontend_strings.detach_file+"</a>]</span>"}b(this.UPLOADED_FILES_ELEMENTS).html(c),b(this.UPLOADED_FILES_ELEMENTS).on("click","a",function(a){a.preventDefault(),a.stopImmediatePropagation();var b=d.getActiveEditor();b.setValue("",!1),b.finishEditing(!1,!1)})},c.prototype.open=function(){this.refreshDimensions()},c.prototype.close=function(){this.editorContainerStyle.display="none"},c.prototype.focus=function(){this.BROWSE_BUTTON.focus()},c.prototype.getEditedCell=function(){var b,a=this.checkEditorSection();switch(a){case"top":b=this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.editorContainerStyle.zIndex=101;break;case"top-left-corner":b=this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.editorContainerStyle.zIndex=103;break;case"bottom-left-corner":b=this.instance.view.wt.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.editorContainerStyle.zIndex=103;break;case"left":b=this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.editorContainerStyle.zIndex=102;break;case"bottom":b=this.instance.view.wt.wtOverlays.bottomOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.editorContainerStyle.zIndex=102;break;default:b=this.instance.getCell(this.row,this.col),this.editorContainerStyle.zIndex=""}return b!=-1&&b!=-2?b:void 0},c.prototype.refreshDimensions=function(){if(this.state===a.EditorState.EDITING){if(this.TD=this.getEditedCell(),!this.TD)return void this.close(!0);var k,b=a.Dom.offset(this.TD),c=a.Dom.offset(this.instance.rootElement),d=a.Dom.getScrollableElement(this.TD),e=this.instance.countRows(),f=b.top-c.top-1-(d.scrollTop||0),g=b.left-c.left-1-(d.scrollLeft||0),h=this.instance.getSettings(),i=h.colHeaders?1:0,j=this.checkEditorSection();switch(j){case"top":k=a.Dom.getCssTransform(this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.holder.parentNode);break;case"left":k=a.Dom.getCssTransform(this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.holder.parentNode);break;case"top-left-corner":k=a.Dom.getCssTransform(this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom-left-corner":k=a.Dom.getCssTransform(this.instance.view.wt.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom":k=a.Dom.getCssTransform(this.instance.view.wt.wtOverlays.bottomOverlay.clone.wtTable.holder.parentNode)}(i&&0===this.instance.getSelected()[0]||h.fixedRowsBottom&&this.instance.getSelected()[0]===e-h.fixedRowsBottom)&&(f+=1),0===this.instance.getSelected()[1]&&(g+=1),k&&k!=-1?this.editorContainerStyle[k[0]]=k[1]:a.Dom.resetCssTransform(this.EDITOR_CONTENT),this.editorContainerStyle.top=f+"px",this.editorContainerStyle.left=g+"px";var m=(this.TD.offsetTop-this.instance.view.wt.wtOverlays.topOverlay.getScrollPosition(),this.TD.offsetLeft-this.instance.view.wt.wtOverlays.leftOverlay.getScrollPosition()),n=a.Dom.innerWidth(this.TD)-8,o=this.instance.view.maximumVisibleElementWidth(m)-9;this.TD.scrollHeight+1;this.editorContainerStyle.width=n+"px",this.editorContainerStyle.maxWidth=o+"px",this.editorContainerStyle.display="block"}},a.editors.ExcelAttachmentEditor=c,a.editors.registerEditor("wdt.attachment",c)}function j(){var b=a.editors.DropdownEditor.prototype.extend();b.confirmWdtDropdownCellValidate=function(a,b,c,d,e){var f=this.propToCol(d),g=this.getCellMeta(c,f);if(a&&"function"==typeof g.cell_validator){var h=!1;return g.cell_validator(b,function(a){return h=a}),h}return a},b.prototype.open=function(){a.editors.DropdownEditor.prototype.open.apply(this,arguments),this.instance.addHook("afterValidate",b.confirmWdtDropdownCellValidate)},b.prototype.close=function(){a.editors.DropdownEditor.prototype.close.apply(this,arguments),this.instance.removeHook("afterValidate",b.confirmWdtDropdownCellValidate)},a.editors.ExcelDropdownEditor=b,a.editors.registerEditor("wdt.dropdown",b)}function k(){var c=a.editors.ExcelDropdownEditor.prototype.extend();c.onBeforeKeyDown=function(b){switch(b.keyCode){case a.helper.KEY_CODES.ENTER:var d=this.getActiveEditor(),e=d.htEditor.getInstance(),f=e.getSelected();if(f){var g=e.getCell(f[0],f[1]);c.selectDropdownItem(g,e,d)}b.stopImmediatePropagation(),b.preventDefault()}},c.selectDropdownItem=function(a,c,d){var e=b(a),f=e.text();e.children("strong:first-child").length?e.html(f):e.html("<strong>"+f+"</strong>");var g=[];b(c.rootElement).find("td strong:first-child").each(function(){g.push(b(this).text())}),d.setValue(g.join())},c.prototype.open=function(){this.instance.addHook("beforeKeyDown",c.onBeforeKeyDown),a.editors.ExcelDropdownEditor.prototype.open.apply(this,arguments);var d=this.htEditor.getInstance(),e=this,f=d.getSettings();d.removeHook("afterRenderer",d.pluginHookBucket.afterRenderer.slice(-1)[0]),d.removeHook("afterOnCellMouseDown",f.afterOnCellMouseDown),d.updateSettings({afterRenderer:function(c,d,f,g,h){var j,i=this.getCellMeta(d,f).filteringCaseSensitive===!0,h=a.helper.stringify(h);h&&(j=i?b.inArray(h,e.query.split(",")):b.inArray(h.toLowerCase(),e.query.toLowerCase().split(",")),j!=-1&&(c.innerHTML=h.replace(h,"<strong>"+h+"</strong>")))},afterOnCellMouseDown:function(a,b,f){var g=this.getValue();void 0!==g&&c.selectDropdownItem(f,d,e),e.focus()}})},c.prototype.finishEditing=function(c,d){if(this.htEditor&&this.htEditor.isListening()&&this.instance.listen(),this.htEditor){var e=[];b(this.htEditor.getInstance().rootElement).find("td strong:first-child").each(function(){e.push(b(this).text())}),this.setValue(this.TEXTAREA.value)}return a.editors.TextEditor.prototype.finishEditing.apply(this,arguments)},c.prototype.close=function(){a.editors.ExcelDropdownEditor.prototype.close.apply(this,arguments),this.instance.removeHook("beforeKeyDown",c.onBeforeKeyDown)},a.editors.ExcelMultiSelectEditor=c,a.editors.registerEditor("wdt.multi-select",c)}function l(c,d,e,f,g,h,i){if(a.TextRenderer.apply(this,arguments),!h)return d;var j=h.split("||"),k=j[0];if(0==k.length)return d;var l=j.length>1?j[1]:k,m=c.getSettings(),n="wdt_link",o="";m.readOnly||(n+="_editable",o='title="ctrl+click to open hyperlink:'+k+'"'),b(d).html('<a class="'+n+'" href="'+k+'" target="_blank" '+o+">"+l+"</a>")}function m(c,d,e,f,g,h,i){if(a.TextRenderer.apply(this,arguments),!h)return d;var j=h.split("||"),k=j[0];if(0==k.length)return d;var l=j.length>1?j[1]:k,m=c.getSettings(),n="wdt_email",o="";m.readOnly||(n+="_editable",o='title="ctrl+click to send email to:'+k+'"'),b(d).html('<a class="'+n+'" href="mailto:'+k+'" '+o+">"+l+"</a>")}function n(b,c,d,e,f,g,h){if(a.TextRenderer.apply(this,arguments),!g)return c;var i=g.split("||"),j=i[0];if(0==j.length)return c;var k=new URI(j),l=k.query(!0),m=k.hasQuery("img_width")?l.img_width:0,n=k.hasQuery("img_height")?l.img_height:0,o="";m>0&&(o+="width:"+m+"px; "),n>0&&(o+="height:"+n+"px;"),o.length>0&&(o='style="'+o+'"');var p="";if(i.length>1&&""!=i[1]){var q=b.getSettings(),r="wdt_link",s="",t=new URI(i[1]);t.removeQuery(["img_width","img_height"]);var u=t.toString();q.readOnly||(r+="_editable",s='title="ctrl+click to open hyperlink:'+u+'"');var v='<img class="wpdt-thumb" src="'+j+'" '+o+" />";p='<a class="'+r+'" href="'+u+'" target="_blank" '+s+">"+v+"</a>"}else p='<img class="wpdt-thumb" src="'+j+'" '+o+" />";c.innerHTML=p}function o(b,c,d,e,f,g,h){var i=a.helper.stringify(g);return i=wdtStripTags(i,"<br/><br><b><strong><h1><h2><h3><a><i><em><ol><ul><li><img><blockquote><div><hr><p><span><select><option><sup><sub>"),c.innerHTML=i,c}function p(c,d,e,f,g,h,i){if(!h||"0000-00-00"==h)return h="",b(d).html(h),a.AutocompleteRenderer(c,d,e,f,g,h,i),d;var j=c.getSettings();j.dataSourceDateFormat!=j.displayDateFormat&&(h=moment(h,j.dataSourceDateFormat).format(j.displayDateFormat)),a.AutocompleteRenderer(c,d,e,f,g,h,i)}function q(c,d,e,f,g,h,i){if(!h||"0000-00-00 00:00:00"==h)return h="",b(d).html(h),a.AutocompleteRenderer(c,d,e,f,g,h,i),d;var j=c.getSettings();h=j.dataSourceDateFormat!=j.displayDateFormat?moment(h,j.dataSourceDateFormat+" HH:mm:ss").format(j.displayDateFormat+" "+j.momentTimeFormat):moment(h,j.dataSourceDateFormat+" HH:mm:ss").format(j.dataSourceDateFormat+" "+j.momentTimeFormat),a.AutocompleteRenderer(c,d,e,f,g,h,i)}function r(c,d,e,f,g,h,i){if(!h)return h="",b(d).html(h),a.AutocompleteRenderer(c,d,e,f,g,h,i),d;var j=c.getSettings();h=moment(h,"HH:mm:ss").format(j.momentTimeFormat),a.AutocompleteRenderer(c,d,e,f,g,h,i)}function s(){a.renderers.registerRenderer("text",o),a.renderers.registerRenderer("wdt.date",p),a.renderers.registerRenderer("wdt.datetime",q),a.renderers.registerRenderer("wdt.time",r),a.renderers.registerRenderer("wdt.link",l),a.renderers.registerRenderer("wdt.email",m),a.renderers.registerRenderer("wdt.image",n)}function t(){e(),f(),g(),h(),i(),j(),k()}function u(){a.wdtDateCell={editor:"wdt.date",validator:a.wdtDateValidator,renderer:"wdt.date"},a.wdtTextCell={editor:"text",renderer:"text"},a.wdtDateTimeCell={editor:"wdt.datetime",validator:a.wdtDateTimeValidator,renderer:"wdt.datetime"},a.wdtTimeCell={editor:"wdt.time",validator:a.wdtTimeValidator,renderer:"wdt.time"},a.wdtMultiSelectCell={editor:"wdt.multi-select",validator:a.wdtMultiSelectValidator,renderer:"text"},a.cellTypes.text=a.wdtTextCell,a.cellTypes["wdt.date"]=a.wdtDateCell,a.cellTypes["wdt.datetime"]=a.wdtDateTimeCell,a.cellTypes["wdt.time"]=a.wdtTimeCell,a.cellTypes["wdt.multi-select"]=a.wdtMultiSelectCell}var c=a.editors.BaseEditor.prototype.beginEditing;a.editors.BaseEditor.prototype.beginEditing=function(a,b){var d=this.instance.getSettings();if(d.wpDataTablesExcelPlugin&&"undefined"==typeof a&&!d.readOnly){var e=d.idColumnKey,f=this.instance.getDataAtRowProp(this.row,e),g=this.cellProperties.defaultValue;!f&&g&&(a=g)}c.apply(this,arguments)};var d=a.editors.BaseEditor.prototype.cancelChanges;a.editors.BaseEditor.prototype.cancelChanges=function(){var a=this.instance.getCellMeta(this.row,this.col);if(a.wpDataTablesExcelPlugin){var c=b(document.activeElement).closest("#"+this.instance.rootElement.id+" > div.invalid_editor_value").removeClass("invalid_editor_value");c.length>0&&c.tooltip("instance")&&c.tooltip("destroy");var e=this.instance.getCellValidator(this.row,this.col),f=this.instance.getDataAtCell(this.row,this.col);if(e){var g=!1;if("function"==typeof e?e.call(a,f,function(a){return g=a}):e instanceof RegExp&&(g=e.test(f)),g){var h=this.instance.getCell(this.row,this.col),i=b(h),j=a.invalidCellClassName;i.hasClass(j)&&i.removeClass(j)}}}d.apply(this,arguments)},a.wdtLinkValidator=function(a,b){null===a&&(a="");var c=!1;if(""==a)c=!0;else{var d=/^([a-z]([a-z]|\d|\+|-|\.)*):(\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?((\[(|(v[\da-f]{1,}\.(([a-z]|\d|-|\.|_|~)|[!\$&'\(\)\*\+,;=]|:)+))\])|((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=])*)(:\d*)?)(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*|(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)|((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)|((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)){0})(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?(||.*)?$/i;c=d.test(a)}b(c)},a.wdtEmailValidator=function(a,b){null===a&&(a="");var c=!1;if(""==a)c=!0;else{var d=/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+(||.*)?$/;c=d.test(a)}b(c)},a.wdtDateValidator=function(b,c){null===b&&(b=""),""==b?c(!0):a.DateValidator.call(this,b,c)},a.wdtDateTimeValidator=function(a,b){null===a&&(a="");var c=this.instance.getSettings(),d=moment(new Date(a)).isValid(),e=moment(a,c.dataSourceDateFormat+" H:mm:ss",!0).isValid();b(""==a||d&&e)},a.wdtTimeValidator=function(a,b){null===a&&(a="");var d=(this.instance.getSettings(),moment(a,"H:mm:ss",!0).isValid());b(""==a||d)},a.wdtMultiSelectValidator=function(a,b){var c=!0;if(null===a&&(a=""),this.source){for(var d=a.toLowerCase().split(","),e=this.source.join(",").toLowerCase().split(","),f=0;f<d.length;f++)if(e.indexOf(d[f])==-1){c=!1;break}}else a&&(c=!1);b(c)},t(),s(),u()}(Handsontable,jQuery),"undefined"==typeof wpDataTablesExcelOptions&&(window.wpDtExcelTables={}),function(a){a(function(){a("div.wpExcelTable").handsontable({wpDataTablesExcelPlugin:!0})})}(jQuery);